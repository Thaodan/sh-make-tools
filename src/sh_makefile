DESTDIR=../pkg
PREFIX=usr
APPNAME=sh_make_tools
VER=2.1
SHPP=shpp/shpp
install_prefix=/usr
SHMAKE="LIBSH=/usr/lib/libsh libdir=$PWD sh_make/sh_make --mod-path=$PWD/sh_make/modules"

default() {
	sh_make_tools
}

prepare() {
 	ln -fs /usr/lib/libsh libsh
}

sh_make_tools() {
	prepare
	sh_make 
	shpp
}


shpp() {
	eval $SHMAKE -f shpp/sh_makefile DESTDIR=../$DESTDIR
}

sh_make() {
 	eval $SHMAKE -f sh_make/sh_makefile DESTDIR=../$DESTDIR
}

sh_make_install() {
	eval $SHMAKE -f sh_make/sh_makefile DESTDIR=../$DESTDIR install	
}

shpp_install() {
	eval $SHMAKE -f shpp/sh_makefile DESTDIR=../$DESTDIR install
}

install() {
	mkdir -p $DESTDIR/$PREFIX	
	shpp_install
	sh_make_install
	
}
clean()  {
	sh  -c 'cd sh_make; . $PWD/sh_makefile; clean'
	rm -f sh_make_pkg \
	      pkg \
	      ../install.sh \
	      libsh
}

installer() {
	load_module configure
	load_module make_installer
	gen_installer > ../install.sh
}
